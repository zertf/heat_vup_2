Данный проект предназначен для использования на установке вакуумного магнетронного распыления ВУП-11М. Система позволяет считывать и регулировать температуру подложкодержателя через регулировку температуры нагревателя с помощью релейного регулирования с коэффициентом усиления и гистерезисом. Дополнительной функцией выступает детектирование утечек воды с установки и уведомление об этом персонала.
Система выводит данные о текущей температуре в вакуумной камере в режиме реального времени. Данные могут быть сохранены для дальнейшего анализа. Основываясь на данных с термопар система может осуществлять релейное регулирование нагрева для поддержания температуры в заданных пределах. Параметры системы можно изменять с помощью раздичных команд.

Комплектация
В комплект системы входят: 
1. Макетная плата с контроллером ESP32 и перемычками;
2. Датчики термопар (внутри вакуумной камеры) моделей MAX31855 и MAX6675;
3. Термопары (внутри вакуумной камеры);
4. Экран;
5. Реле;
6. Сетевые кабеля (2 шт) и розетки для них (2 шт);
7. Зарядка и usb-c кабель;
8. Вилки детекторов протечек (3 шт).

Правила предосторожности
1. Проверяйте правильность подключения термопары. Термопара должна быть подключена соответствующим полюсом непосредственно в датчик термопары, а также плотно и надежно закреплена.
2. Проверяйте работоспособность системы перед откачкой. Подробнее в соответствующем пункте.
3. Не держите дорогостоящую технику (например ноутбук или новенький iphone) подключенной к ESP32 напрямую через кабель во время работы мощных блоков питания. Вместо этого используйте подключение по WiFi или экран установки.
4. Не нагревайте датчики термопар выше максимальных для них температур, указанных в спецификации.

Функции
1. Регулировка температуры по данным с термопары;
2. Детектирование протечек воды на установке с помощью датчиков протечки;
3. Отправка уведомлений об инцедентах на устройства лаборантов;
4. Взаимодействие с компьютером установки через post и get запросы; (пока что нереализовано)
5. Отображение актуальных данных в реальном времени на lcd экран, в Serial интерфейс и в браузер;
6. Получение команд от пользователей через Serial и браузер.

Настройка
0. Для настройки системы вам понадобится плата ESP32 с дополнительной электроникой и компьютер с установленными VS Code и Platformio.
1. Подключите компьютер к ESP32 и убедитесь, что он распознаётся.
2. Запустите VS Code и откройте этот репозиторий.
3. Внесите желаемые изменения в программу. Все настройки системы собраны в начале кода и подробно описаны в комментариях. Учитывайте, что ESP32 сохраняет прежние настройки, доступ к которым можно получить через Seial или WebSerial во внутреннюю память. Изменение таких настроек в начале программы не принесет эффекта, а чтобы изменить их используйте Seial или WebSerial.
4. Загрузите код в ESP32, используя USB и Platformio.
После выполнения указанных выше действий крайне рекомендуется протестировать работоспособность системы во избежание перегрева и некорректной работы. Подключите ESP32 к питанию, выполните комманду i1 в Seial или WebSerial для получения справки о текущем состоянии системы и её настроек. Проерьте работу реле, термопар и датчиков протечки.
Управление системой происходит посредством комманд. Каждая команда состоит из ключа и числа.
  Например, команда 'g260' установит целевую температуру в 260 градусов цельсия.
  g - целевая температура нагрева
  s - статус нагрева. 0 - выкл, 1 - вкл, 2 - готово, 3 - ошибка
  h - гистерезис в градусах цельсия. Вводить значение, умноженное на 1000.
  k - коэффициент обратной связи. Вводить значение, умноженное на 1000.
  r - скорость срабатывания реле в мс
  l - вкл/выкл Serial
  w - вкл/выкл WebSerial. Требует перезагрузку.
  i - вывести эту справку
Таким образом для включения WebSerial нужно ввести w1, для получения справки i1, для установки гистерезиса в значение 1 градус цельсия h1000.

Проверка работоспособности
1. Включите систему.
2. Убедитесь, что температура термопар и контроллеров термопар адекватна. Нагрейте термопары (например руками) и убедитесь, что температура выросла. Затем нагрейте датчики термопар и убедитесь, что показатели их температур тоже выросли. Если температура наоборот упала, возможно термопара подключена в обратной полярности.

Способы подключения
1. Serial. Для подключения установите любую программу, способную осуществлять общение через Serial. В настройках программы установите значение скорости (Baud rate) в 115200.
2. WebSerial. Для подключения загрузите в контроллер прошивку с введенными в неё данными WiFi сети. Подключившись по Serial узнайте ip контроллера и перейдите по нему в браузере. Важно, чтобы браузер был запущен на устройстве, которое подключено к той же WiFi сети.
3. Без подключения. Просто смотрите на экран установки.
4. Post/get (недоступно)

Использование
1. Используйте подходящий способ подключения;
2. Подключите ESP32 к питанию (ноутбук/блок питания/телефон);
3. Дождитесь загрузки системы (несколько секунд);
4. При необходимости запросите справку, введя команду i1;
5. Контролируйте параметры системы любым удобным способом.

Дальнейшие планы
В дальнейшем планируется управлять системой нагрева через интерфейс установки. Для этого планируется реализовать систему отправки и получения post и get запросов в локальной сети лаборатории от ESP32 к Respberry Pi. Плата ESP32 должна выступать в качестве узлового контроллера под управлением компьютера установки.